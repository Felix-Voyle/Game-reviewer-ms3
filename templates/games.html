{% extends "base.html" %}
{% block content %}

<div class="row card-panel search-bar">
  <form action="{{ url_for('search') }}" method="post" class="col s12">
    <div class="row valign-wrapper center-align">
      <div class="input-field col s9 offset-s1">
        <i class="fas fa-search prefix"></i>
        <input type="text" name="query" id="query" minlength="3" class="validate" required>
        <label for="query">Search Games</label>
      </div>
    </div>
    <div class="col offset-s8 s4">
      <button type="submit" class="light-blue">
        <i class="fas fa-search left">Search</i>
      </button>
    </div>
  </form>    
</div>

  {% for game in data['results'] %}
  <div class="row">
    <div class="col s12 offset-m1 m10">
      <div class="card blue-grey darken-1">
        <div class="card-content white-text">
          <img class="game-img" src='{{ game["background_image"] }}'>
          <span class="card-title">{{ game['name'] }}</span>
          <span class="card-info">Released: {{ game['released'] }}</span>
        </div>
        <ul class="card-action collapsible">
          <span class="buy-btn"><a href="https://www.amazon.co.uk/s?k={{ game['name'] }}&i=videogames" target="_blank"
              rel="sponsored">Buy now <i class="fas fa-store-alt"></i></a></span>
          {% if session.user %}    
          <li>
            <div class="collapsible-header">
              <p class="review-dropdwn">Review</p><br>
              <i class="fas fa-chevron-down review-arrow"></i>
            </div>
            <div class="collapsible-body">
              <form method="POST" action="{{ url_for('add_review') }}">
                <textarea rows="12" class="review-txt" placeholder="Write your review..." name="review"></textarea>
                <label for="rating">Rating (out of 10)</label>
                <select id="rating" name="rating">
                  <option value="" disabled selected>What's your rating?</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                </select>
                <input type="text" class="hidden-input" name="game_img" value="{{ game['background_image'] }}">
                <input type="text" class="hidden-input" name="game_name" value="{{ game['name'] }}">
                <button class="review-btn" name="review" type="submit">
                  <i class="fas fa-pencil-alt"></i> Review
                </button>
              </form>
            </div>
          </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </div>
  </div>
  {% endfor %}

  <footer>
    <p class="center-align">All data and images sourced from</p>
    <a href="https://rawg.io/" rel="noopener"><p class="center-align">rawg.io</p></a>
  </footer>

{% endblock %}